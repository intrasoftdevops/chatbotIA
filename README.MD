# Chatbot de Pol칤tica y Tribus (RAG con Gemini)

Este es un chatbot conversacional que responde preguntas sobre pol칤tica colombiana y el sistema de tribus pol칤ticas, utilizando **Retrieval Augmented Generation (RAG)** para buscar informaci칩n relevante en documentos y generar respuestas precisas y contextualmente informadas.

## 游꿢 **Funcionalidades Principales**

### **1. Respuestas sobre Pol칤tica Colombiana**
- Consultas sobre partidos pol칤ticos, democracia, sistema electoral
- Informaci칩n basada en documentos pol칤ticos disponibles
- Respuestas contextuales y emp치ticas

### **2. Sistema de Tribus Pol칤ticas**
- **Detecci칩n autom치tica** de preguntas sobre tribus
- **Informaci칩n sobre coordinadores** y acceso a grupos
- **Explicaci칩n del sistema** de voluntarios organizados por regi칩n
- **Orientaci칩n** para contactar coordinadores locales

### **3. Patrones de Detecci칩n de Tribus/Referidos**
El chatbot reconoce autom치ticamente **60+ variaciones** de preguntas sobre tribus y referidos, incluyendo:
- "M치ndame el link de mi tribu"
- "Env칤ame el link de mi tribu"
- "쯄e puedes mandar el enlace de mi tribu?"
- "P치same el link de la tribu"
- "쮻칩nde est치 el link de mi tribu?"
- "Mandame el link d mi tribu"
- "Enlace tribu porfa"
- "Link tribu ya"
- "Dame el enlace de mi grupo"
- "쮺칩mo entro a la tribu?"
- "Parce, m치ndame el link de mi tribu"
- "Oe, 쯦en칠s el enlace de la tribu?"
- "Mijo, p치same el link del parche"
- "Necesito el link pa entrar a mi tribu"
- "쮻칩nde est치 el bendito link de la tribu?"
- "Quiero entrar a mi tribu"
- "Perd칤 el link de la tribu"
- "Ay칰dame con el link de la tribu"
- "Como es que invito gente?"
- "Dame el link"
- **"M치ndame el link de mis referidos"**
- **"Env칤ame el enlace de mis referidos"**
- **"쯄e puedes mandar el link de referidos?"**
- **"P치same el link de referidos"**
- **"쮻칩nde est치 mi enlace de referidos?"**
- **"Parce, m치ndame el link de mis referidos"**
- **"Link de referidos porfa"**
- **"쮺칩mo obtengo mi link de referidos?"**

**Cobertura completa** de expresiones colombianas, jerga local y variaciones informales. **"Tribu" y "referidos" son sin칩nimos** en el sistema.

### **4. Respuestas Inteligentes**
- **Contextuales**: Adaptadas al tipo de pregunta
- **Informativas**: Explican el sistema de tribus
- **Orientadoras**: Gu칤an hacia coordinadores locales
- **Emp치ticas**: Mantienen un tono amigable

El proyecto est치 construido con:

  * **FastAPI**: Para crear la API REST que aloja el chatbot.
  * **LlamaIndex**: Para la gesti칩n de datos, la creaci칩n del 칤ndice de conocimiento y la implementaci칩n de la l칩gica RAG.
  * **Gemini (Google)**: El modelo de lenguaje grande (LLM) que procesa las preguntas y genera las respuestas.

-----

### Requisitos Previos

Antes de comenzar, aseg칰rate de tener instalado lo siguiente:

  * **Python 3.11** o superior.
  * **Git** (para la gesti칩n de c칩digo).
  * **Una clave API de Gemini** obtenida de [Google AI Studio](https://aistudio.google.com/app/apikey).

-----

### Configuraci칩n del Entorno

Sigue estos pasos para configurar tu proyecto y sus dependencias.

1.  **Clonar el repositorio:**

    ```bash
    git clone https://github.com/sindresorhus/del
    cd chatbotIA
    ```

2.  **Crear y activar el entorno virtual:**

    ```bash
    python -m venv venv
    source venv/bin/activate
    ```

3.  **Configurar tu clave API:**

      * Crea un archivo llamado `.env` en la ra칤z del proyecto.
      * A침ade tu clave API de Gemini en la siguiente l칤nea:
        ```env
        GOOGLE_API_KEY="TU_CLAVE_API_DE_GEMINI"
        ```


4.  **Instalar las dependencias:**

    ```bash
    pip install llama-index-llms-gemini llama-index-embeddings-gemini llama-index pydantic "uvicorn[standard]" google-generativeai fastapi
    ```

-----

### Uso del Proyecto

Una vez que el entorno y las dependencias est칠n configurados, puedes ejecutar el chatbot en dos sencillos pasos.

#### Paso 1: Preparar la Base de Conocimiento

Este comando procesa todos los documentos de la carpeta `data/` y crea un 칤ndice que el chatbot utilizar치. Solo necesitas ejecutarlo una vez o cada vez que a침adas o modifiques documentos.

```bash
python prepare_data.py
```

  * **Verificaci칩n:** Si todo va bien, ver치s un mensaje que dice "칈ndice guardado exitosamente." Se crear치 una carpeta `storage/`.

#### Paso 2: Ejecutar el Servidor del Chatbot

Este comando inicia el servidor web que aloja la API del chatbot. El servidor debe estar corriendo para poder interactuar con el chatbot.

```bash
python -m uvicorn main:app --reload
```

  * **Verificaci칩n:** Si todo funciona, ver치s un mensaje que dice "Uvicorn running on [http://127.0.0.1:8000](http://127.0.0.1:8000)" y "칈ndice cargado y motor de conversaci칩n del chatbot listo para usar.".

-----

### Interactuar con el Chatbot

Mientras el servidor est치 activo, puedes acceder a la interfaz de documentaci칩n interactiva de FastAPI (Swagger UI) para enviar preguntas.

1.  Abre tu navegador web.
2.  Ve a la siguiente direcci칩n:
    ```
    http://127.0.0.1:8000/docs
    ```
3.  En la interfaz, expande el endpoint `POST /chat`, haz clic en "Try it out" e introduce tu pregunta en el campo `query`.
4.  Haz clic en "Execute" para obtener una respuesta de tu chatbot.

-----

### Testing de Funcionalidades

Para probar que el chatbot responde correctamente a preguntas sobre tribus:

```bash
python test_tribal_responses.py
```

Este script prueba:
- **Preguntas sobre tribus**: Verifica que el chatbot detecte y responda apropiadamente
- **Preguntas de control**: Confirma que no mencione tribus en preguntas generales
- **Respuestas contextuales**: Valida que las respuestas sean relevantes

-----

### Ejemplos de Uso

#### Preguntas sobre Tribus:
```
Usuario: "쯄e puedes mandar el link de mi tribu?"
Bot: "Las tribus son grupos de voluntarios organizados por regi칩n. Para obtener el enlace de tu tribu espec칤fica, necesitas contactar a tu coordinador local. 쮼n qu칠 ciudad vives? Te puedo ayudar a contactar al coordinador de tu zona."
```

#### Preguntas Generales de Pol칤tica:
```
Usuario: "쯈u칠 es la democracia?"
Bot: "La democracia es un sistema pol칤tico donde el poder reside en el pueblo..."
```

-----

### API Endpoints

- **GET /**: Mensaje de bienvenida
- **POST /chat**: Endpoint principal para enviar preguntas
  - Body: `{"query": "tu pregunta", "session_id": "identificador_sesion"}`
  - Response: `{"response": {"response": "respuesta del bot"}}`


